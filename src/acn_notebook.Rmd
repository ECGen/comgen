---
title: "Genetic Effects of a Foundation Tree on Networks of Leaf Modifying Arthropods"
date: 
output: pdf_document
theme: bootswatch
---

```{r "libraries", eval = TRUE, results = 'hide', echo = FALSE, message = FALSE}
libs <- c("ComGenR", "coNet")
if (!(all(libs %in% installed.packages()[, 1]))){
    devtools::install_github("ECGen/ComGenR")
    devtools::install_github("ECGen/coNet", ref = "master")
}
sapply(libs, require, character.only = TRUE, quietly = TRUE)
```

# Species/Functional Groups

- PB = P. betae 
- pb.pred = parasitic fly
- pb.abort = 
- edge.fold = sawfly
- pinch =
- mid.miner = lep
- edge.miner = lep
- tip.miner = lep
- fish.eye = ??
- tier = lep
- thrips = Thysanura
- chew.holes = ??
- chomp = large herbivore
- scrape = radula
- chew.edge = lep?


# Pre-processing Data
## Load datasets
```{r "Load data", cache = TRUE, eval = TRUE, results = "hide"}
pit <- read.csv('../data/acn/arth_cooc_PIT_Lau.csv')
pit[is.na(pit)] <- 0
```

## Restrict main analysis to live leaves only
```{r "Live only", cache = TRUE, eval = TRUE, results = "hide"}
### separating out "fungal" necrosis
### necrosis <- pit$fungal
pit <- pit[,colnames(pit) != 'fungal']
```

## Remove Genotype 1007
```{r "Remove 1007", cache = TRUE, eval = TRUE, results = "hide"}
pit <- pit[pit[, "geno"] != "1007", ]

```

## Remove mite
```{r "Remove mite", cache = TRUE, eval = TRUE, results = "hide"}
pit <- pit[, colnames(pit) != "mite"]

```

## Combine gall variants
```{r "Combine PB", cache = TRUE, eval = TRUE, results = "hide"}
pb <- pit$pb.upper + pit$pb.lower + pit$pb.woody 
pb.pred <- pit$pb.pred + pit$pb.woody.pred + pit$pb.hole
pb.abort <- pit$pb.abort
pit <- pit[,!(grepl('pb',colnames(pit)))]
pit <- data.frame(pit,pb.abort,pb.pred,pb)
pit <- data.frame(pit[,1:6],pit[,ncol(pit):7])
tree.info <- paste(pit[, "tree"], pit[, "geno"], pit[, "leaf.type"])
tree.arth <- pit[, 7:ncol(pit)]
tree.arth <- split(tree.arth, tree.info)

```


## Create the community matrix
```{r "Create com mat", cache = TRUE, eval = TRUE, results = "hide"}
com.acn <- do.call(rbind, lapply(tree.arth, function(x) apply(x, 2, sum)))

```

## Tree level network models
```{r "Tree level nets", cache = TRUE, eval = TRUE, results = "hide"}
cn.acn <- lapply(tree.arth, coNet, ci.p = 95, cond = TRUE)

```

## Tree network distances
```{r "net distances", cache = TRUE, eval = TRUE, results = "hide"}
d.cn.acn <- netDist(cn.acn, method = "euclidean")

```

## Calculate network metrics
```{r "net metrics", cache = TRUE, eval = TRUE, results = "hide"}
l.cn.acn <- do.call(rbind, lapply(cn.acn, enaR:::structure.statistics))[, "L"]
cen.cn.acn <- unlist(lapply(cn.acn, function(x) 
    sna::centralization(x, FUN = sna::degree, normalize = FALSE)))
nm.cn.acn <- data.frame(L = l.cn.acn, C = cen.cn.acn)

```

## Tree info compilation
```{r "tree info", cache = TRUE, eval = TRUE, results = "hide"}
acn.dat <- data.frame(do.call(rbind, strsplit(names(cn.acn), split = " ")))
names(acn.dat) <- c("tree", "geno", "leaf.type")

```

## Limit senscent trees with greater than 20 leaves
```{r "limit sen to 20", cache = TRUE, eval = TRUE, results = "hide"}
n.sen <- unlist(lapply(tree.arth[acn.dat[, "leaf.type"] == "sen"], nrow))
n.live <- unlist(lapply(tree.arth[acn.dat[, "leaf.type"] == "live"], nrow))
sen.trees <- tree.arth[names(tree.arth) %in% names(n.sen)[n.sen >= 20]]
sen.dat <- data.frame(do.call(rbind, strsplit(names(sen.trees), split = " ")))
colnames(sen.dat) <- c("tree", "geno", "leaf.type")
com.sen <- do.call(rbind, lapply(sen.trees, function(x) apply(x, 2 ,sum)))
```


## Network ordination
```{r "net ord", cache = TRUE, eval = TRUE, results = "hide"}
if (file.exists("../results/nms_cn_acn.rda")){
    nms.cn.acn <- dget("../results/nms_cn_acn.rda")
}else {
    set.seed(1234)
    ##    nms.cn.acn <- nmds(d.cn.acn, 2, 2)
    nms.cn.acn <- nmds(netDist(cn.acn[grepl("live", names(cn.acn))]), 2, 2)
    dput(nms.cn.acn, "../results/nms_cn_acn.rda")
}
ord.cn.acn <- nmds.min(nms.cn.acn)
vec.com.acn <- envfit(ord.cn.acn, 
                      com.acn[grepl("live", rownames(com.acn)), apply(com.acn, 2, sum) > 10])
vec.nm.acn <- envfit(ord.cn.acn, nm.cn.acn[grepl("live", rownames(nm.cn.acn)), ])

```

## Senescent network models
```{r "sen nets", cache = TRUE, eval = TRUE, results = "hide"}
cn.sen <- lapply(sen.trees, coNet, ci.p = 95, cond = TRUE)

```

## Leaf sample size relativization
```{r "leaf isa", cache = TRUE, eval = TRUE, results = "hide"}
lsr <- unlist(lapply(tree.arth, nrow))
com.acn.lsr <- com.acn / lsr
```

# Main Results

Note: genotype 1007 is removed because it only has one rep

## Genotype replication
```{r "geno isa", cache = TRUE, eval = TRUE, results = "show"}
table(acn.dat[acn.dat[, "leaf.type"] == "live", "geno"])
table(sen.dat[, "geno"])
```

## Total abundance
```{r "", cache = TRUE, eval = TRUE, results = "show"}
abund <- apply(com.acn, 1, sum)
abund <- apply(com.acn[acn.dat[, "tree"] %in% sen.dat[, "tree"], ], 1, sum)
reml.abund.acn <- lme4::lmer(I(abund^(1/2)) ~ (1 | geno), 
                           data = acn.dat[acn.dat[, "tree"] %in% sen.dat[ ,"tree"],],
                           REML = TRUE)
p.reml.abund.acn <- RLRsim::exactRLRT(reml.abund.acn)
p.reml.abund.acn
                                        # live trees
RLRsim::exactRLRT(
    lme4::lmer(I(abund[acn.dat[, "leaf.type"] == "live"]^(1/2)) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               REML = TRUE)
)
                                        # sen trees
sen.A <- apply(com.sen, 1, sum)
RLRsim::exactRLRT(
    lme4::lmer(I(sen.A) ~ (1 | geno), 
               data = sen.dat,
               REML = TRUE)
)
```

## Richness
```{r "", cache = TRUE, eval = TRUE, results = "show"}
rich <- apply(com.acn[acn.dat[, "tree"] %in% sen.dat[, "tree"], ], 1, 
              function(x) sum(sign(x)))
reml.rich.acn <- lme4::lmer(I(rich^(1/2)) ~ (1 | geno), 
                           data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ],
                           REML = TRUE)
p.reml.rich.acn <- RLRsim::exactRLRT(reml.rich.acn)
p.reml.rich.acn
                                        # live trees
RLRsim::exactRLRT(
    lme4::lmer(I(rich[acn.dat[, "leaf.type"] == "live"]^(1/2)) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               REML = TRUE)
)
                                        # sen trees
sen.R <- apply(com.sen, 1, function(x) sum(sign(x)))
RLRsim::exactRLRT(
    lme4::lmer(I(sen.R) ~ (1 | geno), 
               data = sen.dat,
               REML = TRUE)
)
```

## Community Similarity
```{r "", cache = TRUE, eval = TRUE, results = "show"}
rel.com.acn <- rel(com.acn[acn.dat[, "tree"] %in% sen.dat[, "tree"], ])
ds <- rep(min(rel.com.acn[rel.com.acn != 0]) / 100, nrow(rel.com.acn))
rel.com.acn <- cbind(rel.com.acn, ds)
                                        # combined
set.seed(12234)
vegan::adonis2(rel.com.acn ~ geno * leaf.type, 
               data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ], 
               strata = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], "tree"],
               perm = 10000, sqrt.dist = TRUE, mrank = TRUE)
                                        # live
set.seed(12234)
vegan::adonis2(rel.com.acn[acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], 
                                   "leaf.type"] == "live", ] ~ geno, 
               data = acn.dat[acn.dat[, "leaf.type"] == "live" & 
                                  acn.dat[, "tree"] %in% sen.dat[, "tree"], ], 
               perm = 10000, sqrt.dist = FALSE, mrank = TRUE)
                                        # sen
set.seed(12234)
vegan::adonis2(com.sen ~ geno, 
               data = sen.dat, 
               perm = 10000, sqrt.dist = TRUE, mrank = TRUE)
```

## Network similarity
```{r "", cache = TRUE, eval = TRUE, results = "show"}
set.seed(12234)
vegan::adonis2(netDist(cn.acn[acn.dat[, "tree"] %in% sen.dat[, "tree"]]) ~ 
                   leaf.type * geno,
               data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ], 
               strata = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], "tree"],
               sqrt.dist = FALSE, mrank = TRUE)
                                        # Live
set.seed(12234)
vegan::adonis2(netDist(cn.acn[acn.dat[, "leaf.type"] == "live"]) ~ geno,  
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               sqrt.dist = FALSE, mrank = TRUE)
                                        # with PB
pb <- com.acn[grepl("live", rownames(com.acn)), "pb"]
set.seed(12234)
vegan::adonis2(netDist(cn.acn[acn.dat[, "leaf.type"] == "live"]) ~ pb + geno,  
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               sqrt.dist = FALSE, mrank = TRUE)

                                        # Senescence
set.seed(12234)
vegan::adonis2(netDist(cn.sen) ~ geno,  data = sen.dat, 
               sqrt.dist = FALSE, mrank = TRUE)
                                        # with pb
pb.sen <- com.sen[, "pb"]
set.seed(12234)
vegan::adonis2(netDist(cn.sen) ~ geno + pb.sen,  data = sen.dat, 
               sqrt.dist = FALSE, mrank = TRUE)

```

## Network metrics
```{r "", cache = TRUE, eval = TRUE, results = "show"}
                                        # number of links
reml.l.acn <- lme4::lmer(I(l.cn.acn^(1/1)) ~ (1 | geno), 
                           data = acn.dat,
                           REML = TRUE)
p.reml.l.acn <- RLRsim::exactRLRT(reml.l.acn)
p.reml.l.acn
RLRsim::exactRLRT(
    lme4::lmer(I(l.cn.acn[acn.dat[, "leaf.type"] == "live"]^(1/1)) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               REML = TRUE)
)
                                        # centralization
reml.cen.acn <- lme4::lmer(I(cen.cn.acn^(1/2)) ~ (1 | geno), 
                           data = acn.dat,
                           REML = TRUE)
p.reml.cen.acn <- RLRsim::exactRLRT(reml.cen.acn)
p.reml.cen.acn
RLRsim::exactRLRT(
    lme4::lmer(I(cen.cn.acn[acn.dat[, "leaf.type"] == "live"]^(1/2)) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "leaf.type"] == "live", ],
               REML = TRUE)
)
```

## Proportion of PB singles, doubles and triples
```{r "", cache = TRUE, eval = TRUE, results = "show"}
n.leaf <- unlist(lapply(tree.arth, nrow))
pb1 <- unlist(lapply(tree.arth, function(x) sum(sign(x[, "pb"] == 1))))
pb2 <- unlist(lapply(tree.arth, function(x) sum(sign(x[, "pb"] == 2))))
pb3 <- unlist(lapply(tree.arth, function(x) sum(sign(x[, "pb"] == 3))))
pb4 <- unlist(lapply(tree.arth, function(x) sum(sign(x[, "pb"] == 4))))
pb.1 <- unlist(lapply(tree.arth, function(x) sum(sign(x[, "pb"] == 1))))
pb1.d <- pb1[grepl("live", names(pb1))]/n.leaf[grepl("live", names(n.leaf))] - 
    pb1[grepl("sen", names(pb1))]/n.leaf[grepl("sen", names(n.leaf))]
pb2.d <- pb2[grepl("live", names(pb2))]/n.leaf[grepl("live", names(n.leaf))] - 
    pb2[grepl("sen", names(pb2))]/n.leaf[grepl("sen", names(n.leaf))]
pb3.d <- pb3[grepl("live", names(pb3))]/n.leaf[grepl("live", names(n.leaf))] - 
    pb3[grepl("sen", names(pb3))]/n.leaf[grepl("sen", names(n.leaf))]

                                        # pb1
RLRsim::exactRLRT(
    lme4::lmer(I(pb1.d[acn.dat[, "tree"] %in% sen.dat[, "tree"]]) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ],
               REML = TRUE)
)
                                        # pb2
RLRsim::exactRLRT(
    lme4::lmer(I(pb2.d[acn.dat[, "tree"] %in% sen.dat[, "tree"]]) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ],
               REML = TRUE)
)
                                        # pb3
RLRsim::exactRLRT(
    lme4::lmer(I(pb3.d[acn.dat[, "tree"] %in% sen.dat[, "tree"]]) ~ (1 | geno), 
               data = acn.dat[acn.dat[, "tree"] %in% sen.dat[, "tree"], ],
               REML = TRUE)
)
```

## No genotype effect, so all trees are tested together
```{r "", cache = TRUE, eval = TRUE, results = "show"}
t.test(pb1.d)
t.test(pb2.d)
t.test(pb3.d)

```

## Leaf type indicator species
```{r cache = TRUE, eval = TRUE, echo = TRUE}
isa.type <- labdsv::indval(com.acn.lsr, acn.dat[, "leaf.type"])
summary(isa.type)

```

## Genotype indicator species
```{r cache = TRUE, eval = TRUE, echo = TRUE}
isa.geno <- labdsv::indval(com.acn.lsr, acn.dat[, "geno"])
summary(isa.geno)
```

## Genotype-species clusters
```{r cache = TRUE, eval = TRUE, echo = TRUE}
gsc <- computeModules(com.acn.lsr)
slot(gsc, "likelihood")
```

## Cluster based on PB similarity
```{r cache = TRUE, eval = TRUE, echo = FALSE, message = FALSE}
ls.com.acn <- apply(com.acn, 2, function(x, y) tapply(x, y, sum), y = acn.dat[, "tree"])
ls.com.geno <- tapply(as.character(acn.dat[, "geno"]), acn.dat[, "tree"], function(x) x[1])
ls.pb <- data.frame(pb = ls.com.acn[, "pb"], ds = rep(0.0001, nrow(ls.com.acn)))
adonis2(vegdist(ls.pb) ~ ls.com.geno, mrank = FALSE, sqrt.dist = TRUE, perm = 10000)
pb.ord <- nmds(vegdist(ls.pb), 2, 2)

```

## 

## Modularity of bipartite networks
```{r cache = TRUE, eval = FALSE, echo = TRUE}
bipartite::computeModules(com.acn[grepl("live", 
                                        rownames(com.acn)), ])
bipartite::computeModules(com.acn[grepl("sen", 
                                        rownames(com.acn)), ])
```


# Plots

## Main Results

- Genotypes differ in network structure on living leaves
- Response to PB is linked to senescence, more PB higher prob(senscence)

```{r "pb sen vs live", cache = TRUE, eval = TRUE, results = "show", dev = "pdf", fig.height = 5, fig.width = 6}
## mdc.plot(ls.com.geno, ls.pb[, 1], ylim = c(0, 25), 
##          xlab = "Tree Genotype", ylab = "P. betae", std = FALSE,
##          ord = order(tapply(ls.pb[, 1], ls.com.geno, mean), decreasing = TRUE))
mdc.plot(acn.dat[acn.dat[, "leaf.type"] == "sen", "geno"], 
         com.acn[acn.dat[, "leaf.type"] == "sen", "pb"], ylim = c(0, 16), 
         xlab = "Tree Genotype", ylab = "P. betae", std = FALSE,
         ord = order(tapply(com.acn[acn.dat[, "leaf.type"] == "sen", "pb"], 
             acn.dat[acn.dat[, "leaf.type"] == "sen" , "geno"], mean), decreasing = TRUE))

mdc.plot(acn.dat[acn.dat[, "leaf.type"] == "live", "geno"], 
         com.acn[acn.dat[, "leaf.type"] == "live", "pb"], 
         pch = 1, xlab = "Tree Genotype", ylab = "P. betae", std = FALSE,
         ord = order(tapply(com.acn[acn.dat[, "leaf.type"] == "sen", "pb"], 
             acn.dat[acn.dat[, "leaf.type"] == "sen" , "geno"], mean), decreasing = TRUE), 
         add = TRUE, xjit = 0.0001)
legend("topright", legend = c("Senescent", "Living"), pch = c(19, 1))
```

```{r "pb ordination", cache = TRUE, eval = TRUE, results = "show", dev = "pdf", fig.height = 5, fig.width = 5, warning = FALSE}
coord <- ch.plot(nmds.min(pb.ord), g = ls.com.geno, mu.pch = 19, pt.col = "white", cex = 4)
text(coord, labels = rownames(coord))
plot(envfit(nmds.min(pb.ord), ls.pb))
```


```{r "", cache = TRUE, eval = TRUE, results = "show", dev = "pdf", fig.height = 5, fig.width = 5}
                                        # Pb frequency
plot(table(pit[, "leaf.type"]))
table(pit[pit[, "leaf.type"] == "live", "pb"])
table(pit[pit[, "leaf.type"] == "sen", "pb"])
```

Need to fix the following:

```{r "", cache = TRUE, eval = FALSE, results = "show", dev = "pdf"}
                                        # total abundance (live vs sen)
                                        # richness (live vs sen)
mdc.plot(acn.dat[, "leaf.type"], abund, ylim = c(-1.5, 1.5), 
         xlab = "Tree Genotype", ylab = "Value", std = TRUE, 
         ord = order(tapply(abund, acn.dat[, "leaf.type"], mean), decreasing = TRUE))
mdc.plot(acn.dat[, "leaf.type"], rich, add = TRUE, pch = 1, xjit = 0,
         ord = order(tapply(abund, acn.dat[, "leaf.type"], mean), decreasing = TRUE))
legend("topright", legend = c("Abundance", "Richness"), pch = c(19, 1), bty = "none")
```

Need to fix the following:

```{r "", cache = TRUE, eval = FALSE, results = "show", dev = "pdf"}
                                     # abundance and richness
mdc.plot(acn.dat[, "geno"], abund, ylim = c(-1.5, 1.5), 
         xlab = "Tree Genotype", ylab = "Standardized Metric",
         ord = order(tapply(abund, acn.dat[, "geno"], mean), decreasing = TRUE))
mdc.plot(acn.dat[, "geno"], rich, add = TRUE, pch = 1, xjit = 0.01,
         ord = order(tapply(abund, acn.dat[, "geno"], mean), decreasing = TRUE))
legend("topright", legend = c("Abundance", "Richness"), pch = c(19, 1), bty = "none")
```

Need to fix the following:

```{r "", cache = TRUE, eval = FALSE, results = "show", dev = "pdf"}
                                        # Links and centralization
mdc.plot(acn.dat[, "geno"], l.cn.acn, ylim = c(-1, 1.5), 
         xlab = "Tree Genotype", ylab = "Standardized Metric",
         ord = order(tapply(abund, acn.dat[, "geno"], mean), decreasing = TRUE))
mdc.plot(acn.dat[, "geno"], cen.cn.acn, add = TRUE, pch = 1, xjit = 0.01,
         ord = order(tapply(abund, acn.dat[, "geno"], mean), decreasing = TRUE))
legend("topright", legend = c("Links", "Centralization"), pch = c(19, 1), bty = "none")
```

## Network Plots

```{r "", cache = TRUE, eval = TRUE, results = "show", dev = "pdf"}
                                       # Live versus Sen
par(mfrow = c(1, 2))
set.seed(12234)
net.col <- sign(netMean(cn.acn))
net.col[net.col == -1] <- "red"
net.col[net.col == "1"] <- "darkgrey"
coord <- gplot(abs(netMean(cn.acn[acn.dat[, "leaf.type"] == "live"])), 
               gmode = "digraph", 
               displaylabels = TRUE, 
               edge.lwd = (abs(netMean(cn.acn[acn.dat[, "leaf.type"] == "live"]))) * 10,
               edge.col = net.col,
               vertex.col = "black", 
               vertex.cex = 0.5,
               arrowhead.cex = 0.5, 
               label.cex = 0.75, 
               main = "Live")
net.col <- sign(netMean(cn.sen))
net.col[net.col == -1] <- "red"
net.col[net.col == "1"] <- "darkgrey"
gplot(abs(netMean(cn.sen)), 
      coord = coord, 
      gmode = "digraph", 
      displaylabels = TRUE, 
      edge.lwd = (abs(netMean(cn.sen))) * 10,
      edge.col = net.col,
      vertex.col = "black", 
      vertex.cex = 0.5,
      arrowhead.cex = 0.5, 
      label.cex = 0.75, 
      main = "Senescent")
```

```{r "", cache = TRUE, eval = TRUE, results = "show", dev = "pdf"}
                                        # By Genotype
par(mfrow = c(1, 2))
set.seed(12234)
net.col <- sign(netMean(cn.acn))
net.col[net.col == -1] <- 2
net.col[net.col == 1] <- "darkgrey"
# pdf(file = "../results/acn_live_nets.pdf", width = 9, height = 9)
par(mfrow = c(3, 3), mar = c(0, 0, 1, 0))
coord <- gplot(abs(netMean(cn.acn[acn.dat[, "leaf.type"] == "live"])), 
               gmode = "digraph", 
               displaylabels = TRUE, 
               edge.lwd = (abs(netMean(cn.acn[acn.dat[, "leaf.type"] == "live"]))) * 10,
               edge.col = net.col,
               vertex.col = "black", 
               vertex.cex = 0.5,
               arrowhead.cex = 0.5, 
               label.cex = 0.75, 
               main = "Mean")
for (i in unique(acn.dat[, "geno"])){
    gplot(abs(netMean(cn.acn[acn.dat[, "geno"] == i & 
                                 acn.dat[, "leaf.type"] == "live"])), 
          coord = coord,
          gmode = "digraph", 
          displaylabels = TRUE, 
          edge.lwd = (abs(netMean(cn.acn[acn.dat[, "geno"] == i & 
                                             acn.dat[, "leaf.type"] == "live"]))) * 10, 
          edge.col = net.col,
          vertex.col = "black", 
          vertex.cex = 0.5,
          arrowhead.cex = 0.5, 
          label.cex = 0.75, 
          main = i)
}
# dev.off()
```

```{r "", cache = TRUE, dev = "pdf", fig.height = 5, fig.width = 5, fig.cap = "Network distance ordination"}
                                        # Network ordination
coord <- ch.plot(ord.cn.acn, g = acn.dat[acn.dat[, "leaf.type"] == "live", "geno"], 
                 cex = 3, mu.pch = 19, pt.col = "white")
text(coord, labels = rownames(coord))
plot(vec.com.acn, col = "grey")
plot(vec.nm.acn, col = "red")
```

## Bipartite representation
```{r "", cache = TRUE, dev = "pdf", fig.height = 10, fig.width = 5}
plotModuleWeb(gsc)
```

# Library call script
```{r "libraries script", eval = FALSE}
libs <- c("ComGenR", "coNet")
if (!(all(libs %in% installed.packages()[, 1]))){
    devtools::install_github("ECGen/ComGenR")
    devtools::install_github("ECGen/coNet", ref = "master")
}
sapply(libs, require, character.only = TRUE, quietly = TRUE)
```

# Tables

```{r results = "asis", eval = TRUE}
vf.com.tab <- data.frame(vec.com.acn$vectors[c("r", "pvals")])
vf.com.tab <- vf.com.tab[order(vf.com.tab[, "r"], decreasing = TRUE),]
print(xtable::xtable(vf.com.tab, 
                     caption = "Table of leaf modifier vector analyses.", 
                     digits = 3))
```
